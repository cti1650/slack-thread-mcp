{
  "_comment": "Claude Code settings.json / settings.local.json の設定例",
  "_usage": "このファイルの内容を .claude/settings.json または .claude/settings.local.json にコピーしてください",
  "_env_note": ".env ファイルまたは settings.local.json の env セクションに SLACK設定を配置してください",
  "_how_it_works": [
    "SessionStartで--silentにより Slack投稿をスキップし、--save-envで job-id を環境変数に保存します",
    "--stdinで標準入力からClaude Codeのコンテキスト情報（session_id, prompt, tool_name等）を受け取ります",
    "PostToolUseでは進捗メッセージを上書き更新（upsert）し、スレッドをコンパクトに保ちます",
    "Stop/Notificationでは PostToolUse のメッセージを上書きして最終状態を表示します",
    "UserPromptSubmitでは新しいメッセージを投稿します"
  ],
  "_message_flow": [
    "SessionStart → job-idを保存のみ（--silentで投稿しない）",
    "UserPromptSubmit → 新規投稿「Prompt: ...」← ここで初めてスレッド作成",
    "PostToolUse (1回目) → 上書き「Read: ...」",
    "PostToolUse (2回目) → 上書き「Edit: ...」",
    "PostToolUse (3回目) → 上書き「Bash: ...」",
    "Stop → 上書き「Response: ...」← PostToolUseのメッセージを上書き",
    "UserPromptSubmit → 新規投稿「Prompt: ...」（次のプロンプト）",
    "Notification → 上書き「Waiting: ...」← PostToolUseのメッセージを上書き",
    "SessionEnd → 完了投稿「Done: ...」"
  ],
  "permissions": {
    "allow": [
      "Bash(npx slack-thread-mcp *)",
      "Bash(npx slack-notify *)",
      "Bash(node build/cli.js *)"
    ]
  },
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp start --stdin --save-env --silent --title=\"Claude Code Task\""
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp update --stdin"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp update --stdin"
          }
        ]
      }
    ],
    "Notification": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp waiting --stdin"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp update --stdin --level=debug"
          }
        ]
      }
    ],
    "SessionEnd": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx slack-thread-mcp complete --stdin --summary=\"Session completed\""
          }
        ]
      }
    ]
  }
}
